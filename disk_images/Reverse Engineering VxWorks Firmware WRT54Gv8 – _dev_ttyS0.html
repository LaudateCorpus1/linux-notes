<!DOCTYPE html>
<html lang="en-US"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://www.devttys0.com/xmlrpc.php">
<title>Reverse Engineering VxWorks Firmware: WRT54Gv8 – /dev/ttyS0</title>
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="/dev/ttyS0 » Feed" href="http://www.devttys0.com/feed/">
<link rel="alternate" type="application/rss+xml" title="/dev/ttyS0 » Comments Feed" href="http://www.devttys0.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="/dev/ttyS0 » Reverse Engineering VxWorks Firmware: WRT54Gv8 Comments Feed" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/feed/">
		<script type="text/javascript" async="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ga.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.devttys0.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.17"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])?!1:!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55358,56760,9792,65039],[55358,56760,8203,9792,65039])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="mantra-style-css" href="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/style.css" type="text/css" media="all">
<style id="mantra-style-inline-css" type="text/css">
 #wrapper { max-width: 1120px; } #content { width: 100%; max-width:800px; max-width: calc( 100% - 320px ); } #primary, #secondary { width:320px; } #primary .widget-title, #secondary .widget-title { margin-right: -2em; text-align: left; } html { font-size:15px; } body, input, textarea {font-family:Segoe UI, Arial, sans-serif; } #content h1, #content h2, #content h3, #content h4, #content h5, #content h6 { margin-left:20px;} .sticky hgroup { background: url(http://www.devttys0.com/wp-content/themes/mantra/resources/images/icon-featured.png) no-repeat 12px 10px transparent; padding-left: 15px; } #header-container > div { margin-top:20px; } #header-container > div { margin-left:40px; } body { background-color:#444444 !important; } #header { background-color:#333333; } #footer { background-color:#222222; } #footer2 { background-color:#171717; } #site-title span a { color:#0D85CC; } #site-description { color:#999999; } #content, #content p, #content ul, #content ol { color:#333333 ;} .widget-area a:link, .widget-area a:visited, a:link, a:visited ,#searchform #s:hover, #container #s:hover, #access a:hover, #wp-calendar tbody td a, #site-info a, #site-copyright a, #access li:hover > a, #access ul ul:hover > a { color:#0D85CC; } a:hover, .entry-meta a:hover, .entry-utility a:hover, .widget-area a:hover { color:#333333; } #content .entry-title a, #content .entry-title, #content h1, #content h2, #content h3, #content h4, #content h5, #content h6 { color:#333333; } #content .entry-title a:hover { color:#000000; } .widget-title { background-color:#444444; } .widget-title { color:#2EA5FD; } #footer-widget-area .widget-title { color:#0C85CD; } #footer-widget-area a { color:#666666; } #footer-widget-area a:hover { color:#888888; } #content .wp-caption { background-image:url(http://www.devttys0.com/wp-content/themes/mantra/resources/images/pins/Pin2.png); } #content p:not(:last-child), .entry-content ul, .entry-summary ul, .entry-content ol, .entry-summary ol { margin-bottom:1.5em;} .entry-meta .entry-time { display:none; } #branding { height:120px ;} 
inline-code { padding: 1px 3px; font-family: Inconsolata, monospace, sans-serif; font-size: 0.85em; white-space: pre-wrap; border: #E3EDF3 1px solid; background: #F7FAFB; border-radius: 2px; }
</style>
<link rel="stylesheet" id="mantra-mobile-css" href="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/style-mobile.css" type="text/css" media="all">
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/jquery.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var mantra_options = {"responsive":"1","image_class":"imageSeven","equalize_sidebars":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/frontend.js"></script>
<link rel="https://api.w.org/" href="http://www.devttys0.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.devttys0.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.devttys0.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Binwalk v0.3.6 Release" href="http://www.devttys0.com/2011/07/binwalk-v0-3-6-release/">
<link rel="next" title="Binwalk v0.3.7 Released" href="http://www.devttys0.com/2011/07/binwalk-v0-3-7-released/">
<meta name="generator" content="WordPress 4.9.17">
<link rel="canonical" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/">
<link rel="shortlink" href="http://www.devttys0.com/?p=259">
<link rel="alternate" type="application/json+oembed" href="http://www.devttys0.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.devttys0.com%2F2011%2F07%2Freverse-engineering-vxworks-firmware-wrt54gv8%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.devttys0.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.devttys0.com%2F2011%2F07%2Freverse-engineering-vxworks-firmware-wrt54gv8%2F&amp;format=xml">
		<script type="text/javascript">
		var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29703784-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();		</script> <!--[if lte IE 8]> <style type="text/css" media="screen"> #access ul li, .edit-link a , #footer-widget-area .widget-title, .entry-meta,.entry-meta .comments-link, .short-button-light, .short-button-dark ,.short-button-color ,blockquote { position:relative; behavior: url(http://www.devttys0.com/wp-content/themes/mantra/resources/js/PIE/PIE.php); } #access ul ul { -pie-box-shadow:0px 5px 5px #999; } #access ul li.current_page_item, #access ul li.current-menu-item , #access ul li ,#access ul ul ,#access ul ul li, .commentlist li.comment ,.commentlist .avatar, .nivo-caption, .theme-default .nivoSlider { behavior: url(http://www.devttys0.com/wp-content/themes/mantra/resources/js/PIE/PIE.php); } </style> <![endif]--><link rel="stylesheet" type="text/css" href="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shCore.css"><link rel="stylesheet" type="text/css" href="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<!--[if lt IE 9]> 
	<script>
	document.createElement('header');
	document.createElement('nav');
	document.createElement('section');
	document.createElement('article');
	document.createElement('aside');
	document.createElement('footer');
	document.createElement('hgroup');
	</script>
	<![endif]--> </head>
<body class="post-template-default single single-post postid-259 single-format-standard">

    <div id="toTop" class="showtop"><i class="crycon-back2top"></i> </div>
	
<div id="wrapper" class="hfeed">


<header id="header">

		<div id="masthead">

			<div id="branding" role="banner">

					
	<div id="header-container">
	
				<div>
				<div id="site-title">
					<span> <a href="http://www.devttys0.com/" title="/dev/ttyS0" rel="home">/dev/ttyS0</a> </span>
				</div>
				<div id="site-description">Embedded Device Hacking</div>
			</div> 	<div class="socials" id="sheader"> 
	
			<a target="_blank" rel="nofollow" href="https://twitter.com/devttyS0" class="socialicons social-Twitter" title="Twitter">
				<img alt="Twitter" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/Twitter.png">
			</a>
            	</div>
		</div> <!-- #header-container -->
					<div style="clear:both;"></div>

			</div><!-- #branding -->

            <a id="nav-toggle"><span>&nbsp; Menu</span></a>
			<nav id="access" class="" role="navigation">

					<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
	<div id="prime_nav" class="menu"><ul>
<li><a href="http://www.devttys0.com/">Home</a></li><li class="page_item page-item-2530"><a href="http://www.devttys0.com/electronics/">Electronics</a></li>
<li class="page_item page-item-884"><a href="http://www.devttys0.com/training/">Training</a></li>
<li class="page_item page-item-7 current_page_parent"><a href="http://www.devttys0.com/blog/">Blog</a></li>
<li class="page_item page-item-978"><a href="http://www.devttys0.com/tools/">Tools</a></li>
<li class="page_item page-item-35"><a href="http://www.devttys0.com/contact/">Contact</a></li>
<li class="page_item page-item-2"><a href="http://www.devttys0.com/about/">About</a></li>
</ul></div>

			</nav><!-- #access -->

		</div><!-- #masthead -->

	<div style="clear:both;"> </div>

</header><!-- #header -->
<div id="main" class="main">
	<div id="forbottom">
		
		<div style="clear:both;"> </div>

		
		<section id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://www.devttys0.com/2011/07/binwalk-v0-3-6-release/" rel="prev"><span class="meta-nav">«</span> Binwalk v0.3.6 Release</a></div>
					<div class="nav-next"><a href="http://www.devttys0.com/2011/07/binwalk-v0-3-7-released/" rel="next">Binwalk v0.3.7 Released <span class="meta-nav">»</span></a></div>
				</div><!-- #nav-above -->

				<article id="post-259" class="post-259 post type-post status-publish format-standard hentry category-reverse-engineering category-tutorials">
					<h1 class="entry-title">Reverse Engineering VxWorks Firmware: WRT54Gv8</h1>
										<div class="entry-meta">
						 <span class="author vcard"> By  <a class="url fn n" rel="author" href="http://www.devttys0.com/author/craig/" title="View all posts by Craig">Craig</a> <span class="bl_sep">|</span></span>  <time class="onDate date published" datetime="2011-07-08T00:57:12+00:00"> <a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/" title="12:57 am" rel="bookmark"><span class="entry-date">July 8, 2011</span> <span class="entry-time"> - 12:57 am</span></a> </time><span class="bl_sep">|</span><time class="updated" datetime="2011-08-03T11:29:50+00:00">August 3, 2011</time> <span class="bl_categ"> <a href="http://www.devttys0.com/category/reverse-engineering/" rel="tag">Reverse Engineering</a>, <a href="http://www.devttys0.com/category/tutorials/" rel="tag">Tutorials</a> </span>  					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>Lately I’ve been working on taking apart some <a href="http://en.wikipedia.org/wiki/VxWorks">VxWorks</a>
 firmware images. Unfortunately, I could find precious little 
information available on the subject, so today we’ll be extracting the 
VxWorks kernel and application code from the WRT54Gv8 <a href="http://homedownloads.cisco.com/downloads/firmware/FW_WRT54Gv8_8.00.8.001_US_20091005.bin">firmware image</a> and analyzing them in <a href="http://www.hex-rays.com/idapro/">IDA Pro</a>.</p>
<p>The WRT54G series infamously switched from Linux to VxWorks with the 
release of the WRT54Gv5. Because VxWorks is a proprietary RTOS, it is a 
less familiar environment than a Linux based system. Even once you 
identify the different sections of the firmware image, there usually 
isn’t a standard file system full of standard ELF executables that can 
be automatically analyzed by a disassembler.</p>
<p>The overall process for reversing this firmware is pretty straight forward:</p>
<ol>
<li>Identify and extract actual executable code from the firmware image</li>
<li>Identify the loading address for the executable code</li>
<li>Load the executable code into IDA Pro at the appropriate loading address</li>
<li>Augment IDA’s auto analysis with manual/scripted analysis</li>
</ol>
<p>Debugging with JTAG or observing debug messages over a serial port 
can probably be substituted for steps #1 and #2, but since I don’t have 
any VxWorks WRT54G routers, this will be a purely firmware based 
analysis.</p>
<p><span id="more-259"></span></p>
<p>The first step is to locate any identifiable data sections in the firmware image:</p>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>binwalk -v FW_WRT54Gv8_8.00.8.001_US_20091005.bin</strong>

Scan Time:    Jul 05, 2011 @ 09:24:20
Magic File:   /usr/local/etc/binwalk/magic.binwalk
Signatures:   64
Target File:  FW_WRT54Gv8_8.00.8.001_US_20091005.bin
MD5 Checksum: 74317a70160f80fa5df01de0e479a39c

DECIMAL   	HEX       	DESCRIPTION
-------------------------------------------------------------------------------------------------------
512       	0x200     	ELF 32-bit LSB executable, MIPS, MIPS-II version 1 (SYSV)
101658    	0x18D1A   	Linux Journalled Flash filesystem, little endian
103664    	0x194F0   	LZMA compressed data, properties: 0x6C, dictionary size: 8388608 bytes, uncompressed size: 3680864 bytes
1146276   	0x117DA4  	LZMA compressed data, properties: 0xA0, dictionary size: 486539264 bytes, uncompressed size: 520093696 bytes
1185153   	0x121581  	gzip compressed data, was "apply.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1185892   	0x121864  	gzip compressed data, was "apply1.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1186870   	0x121C36  	gzip compressed data, was "apply2.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1187499   	0x121EAB  	gzip compressed data, was "apply2sec.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1188483   	0x122283  	gzip compressed data, was "apply3.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1189464   	0x122658  	gzip compressed data, was "applyW.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1190202   	0x12293A  	gzip compressed data, was "bad.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1190724   	0x122B44  	gzip compressed data, was "basic.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1202618   	0x1259BA  	gzip compressed data, was "bkconfig.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:58 2009
1205617   	0x126571  	gzip compressed data, was "chghttps.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
1206740   	0x1269D4  	gzip compressed data, was "ChgLan.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
1207440   	0x126C90  	gzip compressed data, was "common.js", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
1210112   	0x127700  	gzip compressed data, was "Cysaja.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
1210324   	0x1277D4  	gzip compressed data, was "DDNS.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:45:59 2009
1214620   	0x12889C  	gzip compressed data, was "default.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1215253   	0x128B15  	gzip compressed data, was "DEVICE.HTM", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1216309   	0x128F35  	gzip compressed data, was "DHCPTable.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1217539   	0x129403  	gzip compressed data, was "Diag.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1220485   	0x129F85  	gzip compressed data, was "DMZ.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1223383   	0x12AAD7  	gzip compressed data, was "ERRSCRN.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1224077   	0x12AD8D  	gzip compressed data, was "FacDef.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1226898   	0x12B892  	gzip compressed data, was "FilterMac.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1228632   	0x12BF58  	gzip compressed data, was "Filters.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1233858   	0x12D3C2  	gzip compressed data, was "Firewall.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1236986   	0x12DFFA  	gzip compressed data, was "Forward.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1241779   	0x12F2B3  	gzip compressed data, was "getstatus.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1242777   	0x12F699  	gzip compressed data, was "HDDNS.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:00 2009
1244149   	0x12FBF5  	gzip compressed data, was "HDefault.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1245052   	0x12FF7C  	gzip compressed data, was "HDMZ.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1246049   	0x130361  	gzip compressed data, was "HExile.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1247163   	0x1307BB  	gzip compressed data, was "HFilters.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1248531   	0x130D13  	gzip compressed data, was "HFirewall.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1249494   	0x1310D6  	gzip compressed data, was "HForward.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1250527   	0x1314DF  	gzip compressed data, was "HLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1251393   	0x131841  	gzip compressed data, was "HMAC.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1252433   	0x131C51  	gzip compressed data, was "HManage.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1253438   	0x13203E  	gzip compressed data, was "HOBA.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1254564   	0x1324A4  	gzip compressed data, was "HRouting.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1255864   	0x1329B8  	gzip compressed data, was "HSetup.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1257408   	0x132FC0  	gzip compressed data, was "HStatus.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1258783   	0x13351F  	gzip compressed data, was "HUpgrade.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1259855   	0x13394F  	gzip compressed data, was "HVPN.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1260808   	0x133D08  	gzip compressed data, was "HWEP.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1262621   	0x13441D  	gzip compressed data, was "HWireless.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1264097   	0x1349E1  	gzip compressed data, was "HWPA.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1265245   	0x134E5D  	gzip compressed data, was "InLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:01 2009
1266075   	0x13519B  	gzip compressed data, was "language.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1269311   	0x135E3F  	gzip compressed data, was "lastpassword.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1269507   	0x135F03  	gzip compressed data, was "Log.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1272546   	0x136AE2  	gzip compressed data, was "Manage.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1277123   	0x137CC3  	gzip compressed data, was "md5.js", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1278995   	0x138413  	gzip compressed data, was "Outbreak_Alert.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1282781   	0x1392DD  	gzip compressed data, was "OutLog.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1283619   	0x139623  	gzip compressed data, was "ping.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1287957   	0x13A715  	gzip compressed data, was "ptrigger.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1292450   	0x13B8A2  	gzip compressed data, was "qos.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1298667   	0x13D0EB  	gzip compressed data, was "Quarantined.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1300366   	0x13D78E  	gzip compressed data, was "reset.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1301699   	0x13DCC3  	gzip compressed data, was "Routing.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1306547   	0x13EFB3  	gzip compressed data, was "RTable.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1307445   	0x13F335  	gzip compressed data, was "Service.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1310944   	0x1400E0  	gzip compressed data, was "StaLan.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1313858   	0x140C42  	gzip compressed data, was "StaRouter.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1318404   	0x141E04  	gzip compressed data, was "StaWlan.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1324110   	0x14344E  	gzip compressed data, was "summary.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1325773   	0x143ACD  	gzip compressed data, was "sysinfo.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:02 2009
1325986   	0x143BA2  	gzip compressed data, was "test.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1326015   	0x143BBF  	gzip compressed data, was "Traceroute.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1340943   	0x14760F  	gzip compressed data, was "Unauthorized.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1341087   	0x14769F  	gzip compressed data, was "Upgrade.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1344585   	0x148449  	gzip compressed data, was "UpgStat.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1345231   	0x1486CF  	gzip compressed data, was "UpLangPak.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1346753   	0x148CC1  	gzip compressed data, was "VPN.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1352719   	0x14A40F  	gzip compressed data, was "WAdv.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1356924   	0x14B47C  	gzip compressed data, was "WanMAC.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1360319   	0x14C1BF  	gzip compressed data, was "WClient.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1362096   	0x14C8B0  	gzip compressed data, was "WFilter.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1367188   	0x14DC94  	LZMA compressed data, properties: 0x80, dictionary size: 1110966272 bytes, uncompressed size: 218385737 bytes
1379589   	0x150D05  	LZMA compressed data, properties: 0x80, dictionary size: 1110966272 bytes, uncompressed size: 218385737 bytes
1390145   	0x153641  	gzip compressed data, was "Wireless.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1396588   	0x154F6C  	gzip compressed data, was "wlaninfo.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1396765   	0x15501D  	gzip compressed data, was "WMList.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1402406   	0x156626  	gzip compressed data, was "wps_result.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1403174   	0x156926  	gzip compressed data, was "wps_search.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1407322   	0x15795A  	gzip compressed data, was "WSecurity.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:04 2009
1413245   	0x15907D  	gzip compressed data, was "WState.htm", from NTFS filesystem (NT), last modified: Fri Sep  4 03:46:03 2009
1414025   	0x159389  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1415312   	0x159890  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1415961   	0x159B19  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:23 2009
1422692   	0x15B564  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1424577   	0x15BCC1  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1426257   	0x15C351  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1426777   	0x15C559  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1427511   	0x15C837  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1428222   	0x15CAFE  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1440881   	0x15FC71  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1444717   	0x160B6D  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1446043   	0x16109B  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1446740   	0x161354  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1453397   	0x162D55  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1455360   	0x163500  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1457203   	0x163C33  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1457760   	0x163E60  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1458484   	0x164134  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1459130   	0x1643BA  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1470606   	0x16708E  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1474489   	0x167FB9  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:11 2009
1475924   	0x168554  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:12 2009
1476640   	0x168820  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:19 2009
1484040   	0x16A508  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:12 2009
1486131   	0x16AD33  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:12 2009
1487922   	0x16B432  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:13 2009
1488498   	0x16B672  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:13 2009
1489232   	0x16B950  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:14 2009
1490002   	0x16BC52  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:16 2009
1502977   	0x16EF01  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Mon Jul 20 02:06:18 2009
1507309   	0x16FFED  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1508872   	0x170608  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1509579   	0x1708CB  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:23 2009
1517398   	0x172756  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1519422   	0x172F3E  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1521274   	0x17367A  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1521858   	0x1738C2  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1522740   	0x173C34  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1523552   	0x173F60  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1537579   	0x17762B  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1541905   	0x178711  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1543410   	0x178CF2  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1544153   	0x178FD9  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1551383   	0x17AC17  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1553369   	0x17B3D9  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1555240   	0x17BB28  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1555807   	0x17BD5F  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1556608   	0x17C080  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1557451   	0x17C3CB  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1570691   	0x17F783  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1575061   	0x180895  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1576468   	0x180E14  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1577168   	0x1810D0  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1583976   	0x182B68  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1585919   	0x1832FF  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1587626   	0x1839AA  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1588171   	0x183BCB  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1588954   	0x183EDA  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1589732   	0x1841E4  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1602550   	0x1873F6  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1606645   	0x1883F5  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1608110   	0x1889AE  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1608851   	0x188C93  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1616048   	0x18A8B0  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1618053   	0x18B085  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1619884   	0x18B7AC  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1620434   	0x18B9D2  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1621256   	0x18BD08  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1622020   	0x18C004  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1635437   	0x18F46D  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1639557   	0x190485  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1640989   	0x190A1D  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1641705   	0x190CE9  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1648936   	0x192928  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1650918   	0x1930E6  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1652676   	0x1937C4  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1653245   	0x1939FD  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1654035   	0x193D13  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1654781   	0x193FFD  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1668039   	0x1973C7  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1672113   	0x1983B1  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1673513   	0x198929  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1674220   	0x198BEC  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:23 2009
1681271   	0x19A777  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1683281   	0x19AF51  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1685025   	0x19B621  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1685594   	0x19B85A  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1686372   	0x19BB64  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1687111   	0x19BE47  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1699948   	0x19F06C  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1703937   	0x1A0001  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1705425   	0x1A05D1  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1706169   	0x1A08B9  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1713196   	0x1A242C  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1715253   	0x1A2C35  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1717098   	0x1A336A  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1717679   	0x1A35AF  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1718519   	0x1A38F7  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1719332   	0x1A3C24  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1732356   	0x1A6F04  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009
1736429   	0x1A7EED  	gzip compressed data, was "capadmin.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1737865   	0x1A8489  	gzip compressed data, was "capapp.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:18 2009
1738572   	0x1A874C  	gzip compressed data, was "capasg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:24 2009
1745822   	0x1AA39E  	gzip compressed data, was "capsec.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1747816   	0x1AAB68  	gzip compressed data, was "capsetup.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1749609   	0x1AB269  	gzip compressed data, was "capstatus.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:19 2009
1750156   	0x1AB48C  	gzip compressed data, was "ddnsmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1750922   	0x1AB78A  	gzip compressed data, was "errmsg.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:20 2009
1751669   	0x1ABA75  	gzip compressed data, was "help.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:21 2009
1765090   	0x1AEEE2  	gzip compressed data, was "share.js", from NTFS filesystem (NT), last modified: Tue Jul 14 04:38:22 2009

</pre>
</blockquote>
<p>Binwalk has identified a lot of gzipped Web files, a few LZMA signatures, an ELF header, and even a JFFS file system. </p>
<p>The JFFS file system is almost certainly a false positive, so we’ll ignore it.</p>
<p>Looking through a hex dump of the firmware, the gzipped Web files do 
look to be part of a simple file system, similar to the the OW file 
system discussed <a href="http://www.devttys0.com/2011/06/mystery-file-system/">previously</a>.
 However, the Web files are not particularly relevant for the purposes 
of this discussion, so I will forgo an analysis of the file system here;
 if desired, these files can simply be extracted from the firmware image
 and gunzipped.</p>
<p>There were four LZMA signatures found, but all except one have very 
large uncompressed sizes (several hundred MB each), so these are 
probably false positives. However, the first LZMA signature at offset 
0x194F0 is just over 3.5 MB. This is a reasonable size, so let’s extract
 and decompress the LZMA data:</p>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>dd if=FW_WRT54Gv8_8.00.8.001_US_20091005.bin skip=1 bs=103664 of=lzma_data.7z</strong>
16+1 records in
16+1 records out
1665240 bytes (1.7 MB) copied, 0.00559597 s, 298 MB/s
</pre>
</blockquote>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>p7zip -d lzma_data.7z </strong>

7-Zip (A) 9.04 beta  Copyright (c) 1999-2009 Igor Pavlov  2009-05-30
p7zip Version 9.04 (locale=en_US.utf8,Utf16=on,HugeFiles=on,1 CPU)

Processing archive: lzma_data.7z

Extracting  lzma_data

Everything is Ok

Size:       3680864
Compressed: 1665240
</pre>
</blockquote>
<p>It looks like the decompression went OK; let’s run strings and hexdump against the decompressed data to see what we can find:</p>
<blockquote id="lzma_strings">
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>strings lzma_data | less</strong>
NORMAL_CODE_DATA
5VGW$LANGPACK_CODE_DATA=
$MODEL_NAME=WRT54G
$OEM_NAME=LINKSYS
Copyright 2004-2005 CyberTAN Limited
...
GetConnectedDevices
GetRouterLanSettings2
GetWanInfo
GetWanSettings
GetMACFilters2
GetPortMappings
GetDeviceSettings
HTTP/1.1 307 Temporary Redirect
Location: https://%s%s/HNAP1/
HTTP/1.1 500 Internal Server Error
Server: httpd
</pre>
</blockquote>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>hexdump -C lzma_data | head</strong>
00000000  22 00 00 10 00 00 00 00  00 00 00 00 00 00 00 00  |"...............|
00000010  4e 4f 52 4d 41 4c 5f 43  4f 44 45 5f 44 41 54 41  |NORMAL_CODE_DATA|
00000020  01 80 00 08 35 56 47 57  24 4c 41 4e 47 50 41 43  |....5VGW$LANGPAC|
00000030  4b 5f 43 4f 44 45 5f 44  41 54 41 3d 06 01 00 01  |K_CODE_DATA=....|
00000040  24 4d 4f 44 45 4c 5f 4e  41 4d 45 3d 57 52 54 35  |$MODEL_NAME=WRT5|
00000050  34 47 00 24 4f 45 4d 5f  4e 41 4d 45 3d 4c 49 4e  |4G.$OEM_NAME=LIN|
00000060  4b 53 59 53 00 43 6f 70  79 72 69 67 68 74 20 32  |KSYS.Copyright 2|
00000070  30 30 34 2d 32 30 30 35  20 43 79 62 65 72 54 41  |004-2005 CyberTA|
00000080  4e 20 4c 69 6d 69 74 65  64 00 00 00 39 80 1c 3c  |N Limited...9..&lt;|
00000090  50 ba 9c 27 00 10 08 3c  fe ff 09 24 24 40 09 01  |P..'...&lt;...$$@..|
</pre>
</blockquote>
<p>There are definitely some interesting strings in this data, including
 what appears to be application strings for services such as HTTP and 
HNAP. </p>
<p>There is some binary data in there as well, which may or may not be 
executable code. However, if it is executable code, there is no 
distinguishable header or section information; this makes analysis much 
more difficult. We also don't yet know the CPU architecture or endianess
 of the target (although this could be found with a Google search).</p>
<p>We do, however, have an ELF header located at offset 0x200 in the firmware image, so let's take a closer look at that:</p>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>dd if=FW_WRT54Gv8_8.00.8.001_US_20091005.bin bs=512 skip=1 of=elf</strong>
3453+1 records in
3453+1 records out
1768392 bytes (1.8 MB) copied, 0.020778 s, 85.1 MB/s
</pre>
</blockquote>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>file elf </strong>
elf: ELF 32-bit LSB executable, MIPS, MIPS-II version 1 (SYSV), statically linked, not stripped
</pre>
</blockquote>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>strings -n 10 elf | head</strong>
VxWorks5.4.2
Oct  5 2009, 15:15:53
memPartFree
%-5s = %8x
0123456789abcdef
0123456789ABCDEF
bug in vfprintf: bad base
WIND version 2.5
workQPanic: Kernel work queue overflow.
DDDDDDDDDD

</pre>
</blockquote>
<p>It's a little endian MIPS ELF file with several string references to 
'VxWorks', 'Wind River' and 'Kernel'; this looks like it could be the 
VxWorks kernel. Let's load it into IDA and see what we can make of it 
(be sure to select the mipsl CPU):</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_elf.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf-1024x434.png" alt="" title="IDA ELF Analysis" class="aligncenter size-large wp-image-272 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf-1024x434.png 1024w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf-300x127.png 300w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf.png 1439w" sizes="(max-width: 1024px) 100vw, 1024px" width="1024" height="434"></a>
</pre>
<p>Because this image has an ELF header, IDA's auto analysis does a very
 good job of identifying functions and resolving symbols for us. Let's 
take a look at the first subroutine, startInflate:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_elf_mainsub.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_mainsub.png" alt="" title="IDA ELF startInflate" class="aligncenter size-full wp-image-271 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_mainsub.png 754w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_mainsub-300x192.png 300w" sizes="(max-width: 754px) 100vw, 754px" width="754" height="483"></a>
</pre>
<p>The address 0x80001000 is loaded into $v0 and the decompressImage 
function is called; execution then jumps to the address stored in $v0 
(0x80001000). So presumably, the decompressImage function decompresses 
some code to address 0x80001000, which then takes over execution.</p>
<p>Looking at the arguments to decompressImage, the first is 
_binArrayStart and the second is the address 0x80001000. Let's take a 
look at _binArrayStart:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_elf_binarraystart.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_binarraystart.png" alt="" title="IDA ELF _binArrayStart" class="aligncenter size-full wp-image-269 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_binarraystart.png 698w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_binarraystart-300x111.png 300w" sizes="(max-width: 698px) 100vw, 698px" width="698" height="259"></a>
</pre>
<p>The first five bytes at the _binArrayStart address are 6C 00 00 80 
00, which looks like the beginning of an LZMA image. Comparing the bytes
 in _binArrayStart to the LZMA data that we extracted earlier, we see 
that they are identical:</p>
<blockquote>
<pre>embedded@ubuntu:~/WRT54Gv8$ <strong>hexdump -C lzma_data.7z | head</strong>
00000000  6c 00 00 80 00 60 2a 38  00 00 00 00 00 00 11 00  |l....`*8........|
00000010  2c 20 00 df 1e 01 d7 44  6b 43 41 4d a8 aa 91 9c  |, .....DkCAM....|
00000020  11 ed 0d 6b bd 40 da 21  19 b1 16 8b 51 48 b8 a6  |...k.@.!....QH..|
00000030  c9 1f 7e 0b 24 4c 24 14  2b db 64 59 fb 79 2a 3c  |..~.$L$.+.dY.y*&lt;|
00000040  11 70 12 a7 84 78 fc 38  f5 99 ed 0d db 0f c3 64  |.p...x.8.......d|
00000050  4c ca ca 70 31 bc e7 1a  7f 42 51 dc 1f fe 8b dc  |L..p1....BQ.....|
00000060  d0 89 fc 0a 9a dc 03 37  62 e3 75 f3 10 56 7c f8  |.......7b.u..V|.|
00000070  6a c1 14 69 bc 28 e6 fc  48 2e f5 bf b2 22 dc f5  |j..i.(..H...."..|
00000080  ec b1 c7 9b ec 76 93 73  b8 cf fa 2d 06 34 cb 75  |.....v.s...-.4.u|
00000090  4b ed 1f f1 28 d7 00 ea  ae 29 57 19 de 87 42 ae  |K...(....)W...B.|
</pre>
</blockquote>
<p>Looking further into the decompressImage function, we also see that it calls another function named LzmaDecode:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_elf_lzmadecode.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_lzmadecode.png" alt="" title="IDA ELF LzmaDecode" class="aligncenter size-full wp-image-270 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_lzmadecode.png 726w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_elf_lzmadecode-300x115.png 300w" sizes="(max-width: 726px) 100vw, 726px" width="726" height="279"></a>
</pre>
<p>So it appears that the LZMA data that we extracted earlier does 
contain executable code, and that it is decompressed and loaded into 
memory at address 0x80001000. A Google search for 'vxworks lzmadecode' 
turns up some <a href="http://www.hackchina.com/en/cont/27807">source code</a> that confirms this conclusion. </p>
<p>Based on the strings we saw <a href="#lzma_strings">earlier</a>, the LZMA data likely contains the OS application code.</p>
<p>We now have enough information to load the extracted LZMA data into 
IDA for analysis. As with the kernel, we'll set the architecture to 
mipsl, but since this is a binary file we will also have to supply IDA 
with the proper loading information.</p>
<p>To do this, we'll set the ROM start address to 0x80001000, and the 
ROM size to the size of the file, 0x382A60. We'll also set the loading 
address to 0x80001000:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_image_rom.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_rom.png" alt="" title="IDA ROM Layout" class="aligncenter size-full wp-image-282 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_rom.png 518w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_rom-300x277.png 300w" sizes="(max-width: 518px) 100vw, 518px" width="518" height="480"></a>
</pre>
<p>Once the file is loaded into IDA, go to the first byte and press 'c' 
to convert it to code. IDA will start converting bytes to code and 
performing an analysis of the binary file. The very first instruction is
 a jump that conveniently skips over some strings that are located near 
the beginning of the file:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_image_jump.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_jump.png" alt="" title="IDA Code Analysis" class="aligncenter size-full wp-image-281 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_jump.png 776w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_jump-300x177.png 300w" sizes="(max-width: 776px) 100vw, 776px" width="776" height="459"></a>
</pre>
<p>The code looks sane, IDA has identified just over 5,000 functions, and string references look correct too:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_image_strings.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings.png" alt="" title="IDA String Reference" class="aligncenter size-full wp-image-283 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings.png 793w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings-300x119.png 300w" sizes="(max-width: 793px) 100vw, 793px" width="793" height="317"></a>
</pre>
<p>Contrast the above disassembly with the same data after performing 
the same code analysis in IDA, but without setting the proper loading 
address:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_image_bad_strings.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_bad_strings.png" alt="" title="IDA No String Reference" class="aligncenter size-full wp-image-280 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_bad_strings.png 539w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_bad_strings-300x177.png 300w" sizes="(max-width: 539px) 100vw, 539px" width="539" height="319"></a>
</pre>
<p>There is also a decent amount of blue (code) in IDA's navigation bar:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_bar.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar.png" alt="" title="IDA Initial Analysis" class="aligncenter size-full wp-image-309 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar.png 461w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar-300x20.png 300w" sizes="(max-width: 461px) 100vw, 461px" width="461" height="31"></a>
</pre>
<p>Although our efforts have improved IDA's initial analysis, there is 
still a good deal of code that has been missed. I've written some simple
 IDA <a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_scripts.zip">scripts</a> which can be used to get more out of the disassembly.</p>
<p>First, we want to locate unidentified functions by iterating through 
the code looking for common function prologues. If one is found, we'll 
tell IDA to create a function there. This is sometimes a bit trickier 
for MIPS than for the Intel architecture, since function prologues are 
less standardized in MIPS. </p>
<p>The addui instruction is often used to manipulate the stack register 
($sp) at the beginning of a function. We can see that this is the case 
for many of the functions identified by IDA:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/addui_prologue.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/addui_prologue.png" alt="" title="addui Function Prologue" class="aligncenter size-full wp-image-308 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/addui_prologue.png 678w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/addui_prologue-300x192.png 300w" sizes="(max-width: 678px) 100vw, 678px" width="678" height="436"></a>
</pre>
<p>However, there are some functions that precede the addui instruction with an lw instruction:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/lw_addui_prologue.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/lw_addui_prologue.png" alt="" title="lw addui Function Prologue" class="aligncenter size-full wp-image-310 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/lw_addui_prologue.png 765w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/lw_addui_prologue-300x166.png 300w" sizes="(max-width: 765px) 100vw, 765px" width="765" height="424"></a>
</pre>
<p>The create_functions.py IDAPython script will search the code 
(starting at the cursor position) for byte sequences that correspond to 
these instructions, and instruct IDA to convert them to functions.</p>
<p>Looking at the disassembly, the section of data containing the 
binary's strings appears to start at 0x802DDAC0, so I've coded the 
script stop at that address:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_start_strings.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_start_strings.png" alt="" title="IDA Start Strings" class="aligncenter size-full wp-image-298 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_start_strings.png 806w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_start_strings-300x175.png 300w" sizes="(max-width: 806px) 100vw, 806px" width="806" height="472"></a>
</pre>
<p>After running the script, IDA now has over 9,600 defined functions, and a lot more code has been identified:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_bar2.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar2.png" alt="" title="IDA Bar After Function Analysis" class="aligncenter size-full wp-image-312 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar2.png 912w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar2-300x10.png 300w" sizes="(max-width: 912px) 100vw, 912px" width="912" height="32"></a>
</pre>
<p>However, there are still some sections of data that have not yet been analyzed:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_undefined_data.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_undefined_data.png" alt="" title="IDA Undefined Data" class="aligncenter size-full wp-image-317 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_undefined_data.png 757w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_undefined_data-300x101.png 300w" sizes="(max-width: 757px) 100vw, 757px" width="757" height="256"></a>
</pre>
<p>These sections are surrounded by code, and navigating to several of 
these sections and converting them directly to code results in a valid 
disassembly:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_defined_code.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_code.png" alt="" title="IDA Defined Code" class="aligncenter size-full wp-image-314 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_code.png 739w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_code-300x86.png 300w" sizes="(max-width: 739px) 100vw, 739px" width="739" height="214"></a>
</pre>
<p>Since these sections all appear to end with 'jr $ra' (the MIPS return
 instruction), and since they are not referenced by the surrounding 
functions, they are likely functions themselves. </p>
<p>The create_code.py script will walk through the code converting these
 unreferenced bytes to functions (as before, the script will start at 
the cursor position and end at address 0x802DDAC0):</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_defined_function.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_function.png" alt="" title="IDA Defined Function" class="aligncenter size-full wp-image-315 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_function.png 743w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_defined_function-300x148.png 300w" sizes="(max-width: 743px) 100vw, 743px" width="743" height="368"></a>
</pre>
<p>We now have a nice solid block of code in IDA's navigation bar:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_bar3.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar3.png" alt="" title="IDA Navigation Bar" class="aligncenter size-full wp-image-313 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar3.png 911w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_bar3-300x9.png 300w" sizes="(max-width: 911px) 100vw, 911px" width="911" height="28"></a>
</pre>
<p>With the code taken care of, let's turn our attention to the strings.
 Without symbols like we had in the ELF file, we will have to rely on 
string references to provide key insights into what is going on in the 
firmware. However, there are still some ASCII byte arrays that have not 
been converted to strings by IDA:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_string_reference_before_script.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_reference_before_script.png" alt="" title="IDA Non String Reference" class="aligncenter size-full wp-image-294 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_reference_before_script.png 685w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_reference_before_script-300x98.png 300w" sizes="(max-width: 685px) 100vw, 685px" width="685" height="226"></a>
</pre>
<p>Converting these ASCII arrays to strings will make reading the code 
much easier, so the create_ascii.py script converts all ASCII byte 
arrays to strings. As we saw before, the section of the image that 
contains the string data starts at offset 0x802DDAC0, so we'll place the
 cursor at that address in IDA and run the script from there. This 
results in data that is much easier to read and recognize:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_string_fixed.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_fixed.png" alt="" title="IDA String Fixed" class="aligncenter size-full wp-image-316 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_fixed.png 713w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_string_fixed-300x83.png 300w" sizes="(max-width: 713px) 100vw, 713px" width="713" height="199"></a>
</pre>
<p>With our strings now fixed up, let's try to identify some basic functions in the disassembly:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_image_strings.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings.png" alt="" title="IDA String Reference" class="aligncenter size-full wp-image-283 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings.png 793w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_image_strings-300x119.png 300w" sizes="(max-width: 793px) 100vw, 793px" width="793" height="317"></a>
</pre>
<p>There are two function calls here; the first, sub_802A7F90, takes a 
single argument: the number 1, shifted left 16 bits (65536). If the 
return value is zero, a second function, sub_802A06E8 is called. </p>
<p>The second function takes two arguments: a string that contains 
common printf formatting, and the number 65536. The pseudo code looks 
like:</p>
<blockquote>
<pre>if(!sub_802A7F90(65536))
{
   sub_802A06E8("Can't allocate %d bytes of memory\n", 65536);
}
</pre>
</blockquote>
<p>This makes it pretty obvious that sub_802A7F90 is the equivalent of 
malloc, and sub_802A06E8 is printf. We'll rename these functions 
appropriately so that references to them elsewhere in the code will be 
readily apparent:</p>
<pre><a href="http://www.devttys0.com/wp-content/uploads/2011/07/ida_renamed_functions.png"><img src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_renamed_functions.png" alt="" title="IDA Renamed Functions" class="aligncenter size-full wp-image-324 imageSeven" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_renamed_functions.png 787w, Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/ida_renamed_functions-300x120.png 300w" sizes="(max-width: 787px) 100vw, 787px" width="787" height="315"></a>
</pre>
<p>That's it! We now have working disassemblies of both the kernel and 
application code that we can use to further analyze VxWorks for 
additional functions, bugs or vulnerabilities.</p>
											</div><!-- .entry-content -->

					<div class="entry-utility">
						<span class="bl_bookmark">Bookmark the  <a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/" title="Permalink to Reverse Engineering VxWorks Firmware: WRT54Gv8" rel="bookmark">permalink</a>. </span>											</div><!-- .entry-utility -->
				</article><!-- #post-## -->


				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://www.devttys0.com/2011/07/binwalk-v0-3-6-release/" rel="prev"><span class="meta-nav">«</span> Binwalk v0.3.6 Release</a></div>
					<div class="nav-next"><a href="http://www.devttys0.com/2011/07/binwalk-v0-3-7-released/" rel="next">Binwalk v0.3.7 Released <span class="meta-nav">»</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


	<h3 id="comments-title">
		46 Responses to <em>Reverse Engineering VxWorks Firmware: WRT54Gv8</em>	</h3> 
	<ol class="commentlist">
			
			<li class="comment even thread-even depth-1" id="li-comment-1584">
		<div id="comment-1584">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/aa3133f66028b2170068dfd766b82008.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/aa3133f66028b2170068dfd766b82008_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://bear24rw.blogspot.com/" rel="external nofollow" class="url">Max</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1584">
			July 8, 2011 at 5:09 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>That was a great read, thanks!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1584#respond" onclick='return addComment.moveForm( "comment-1584", "1584", "respond", "259" )' aria-label="Reply to Max">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://hackaday.com/2011/07/08/reverse-engineering-vxworks-which-replaces-linux-on-newer-routers/" rel="external nofollow" class="url">Reverse engineering VxWorks (which replaces Linux on newer routers) - Hack a Day</a></p>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1587">
		<div id="comment-1587">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/7cb7e55a5d925e477567b479c6e17e38.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/7cb7e55a5d925e477567b479c6e17e38_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">rf</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1587">
			July 8, 2011 at 3:29 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>great job! thanks for sharing your work proceeding!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1587#respond" onclick='return addComment.moveForm( "comment-1587", "1587", "respond", "259" )' aria-label="Reply to rf">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-1588">
		<div id="comment-1588">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/066df71fb089e5090f8131127b1ce5d6.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/066df71fb089e5090f8131127b1ce5d6_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Pedro</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1588">
			July 8, 2011 at 4:34 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thank you for sharing this good analysis.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1588#respond" onclick='return addComment.moveForm( "comment-1588", "1588", "respond", "259" )' aria-label="Reply to Pedro">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://analyser.fevroplast.gr/?p=5900" rel="external nofollow" class="url">Reverse engineering VxWorks (which replaces Linux on newer routers) | You've been blogged!</a></p>
	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://arindamon.x10.mx/blog/lh/reverse-engineering-vxworks-which-replaces-linux-on-newer-routers/" rel="external nofollow" class="url">.::
 Arindam's Blog ::. » Blog Archive » Reverse engineering VxWorks (which 
replaces Linux on newer routers) » .:: Arindam's Blog ::.</a></p>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1591">
		<div id="comment-1591">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/5dc119182cea09e9cca09dceac255a89.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/5dc119182cea09e9cca09dceac255a89_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Denis</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1591">
			July 8, 2011 at 8:48 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Amazing work ! Thank you.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1591#respond" onclick='return addComment.moveForm( "comment-1591", "1591", "respond", "259" )' aria-label="Reply to Denis">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-1604">
		<div id="comment-1604">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/db89caf54dc0d695f93ccc2cf678fb20.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/db89caf54dc0d695f93ccc2cf678fb20_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://swbae.egloos.com/" rel="external nofollow" class="url">opt9</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1604">
			July 10, 2011 at 12:27 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Former works by me.</p>
<p><a href="http://swbae.egloos.com/1701135" rel="nofollow">http://swbae.egloos.com/1701135</a></p>
<p>meathive won the 1st prize in the GNU Citizen router hacking challenge using my blog post – <a href="http://www.gnucitizen.org/blog/router-hacking-challenge/" rel="nofollow">http://www.gnucitizen.org/blog/router-hacking-challenge/</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1604#respond" onclick='return addComment.moveForm( "comment-1604", "1604", "respond", "259" )' aria-label="Reply to opt9">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1608">
		<div id="comment-1608">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8c636769555fd2f9499c596b30d83260.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8c636769555fd2f9499c596b30d83260_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Victek</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1608">
			July 10, 2011 at 11:57 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>You make my day, great job, Thanks!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1608#respond" onclick='return addComment.moveForm( "comment-1608", "1608", "respond", "259" )' aria-label="Reply to Victek">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-1617">
		<div id="comment-1617">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/90a5d4c7e7a97c3c6a832035bf965b6f.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/90a5d4c7e7a97c3c6a832035bf965b6f_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Victor</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1617">
			July 12, 2011 at 8:38 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>opt9: I’ll be quite if you’re talking some kind of joke. </p>
<p>1. I’m pretty sure A LOT OF PEOPLE have known bugs from WRT54G 
already. You’re not the first. Also, meathive didn’t say he won with 
your bug.</p>
<p>2. This reverse engineering work is not a tricky bug like non-auth 
ftp login. Non-auth ftp login bug has been probably known for even 
11-year old hackers. Not to mention, but, totally, obviously, different.
 Don’t say “former work.”</p>
<p>3. DO YOU WANT TO SAY NON-AUTH BUG IS A SUPER-DUPER BUG? SERIOUSLY?</p>
<p>Thanks, no offense.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1617#respond" onclick='return addComment.moveForm( "comment-1617", "1617", "respond", "259" )' aria-label="Reply to Victor">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-1623">
		<div id="comment-1623">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1623">
			July 13, 2011 at 1:03 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Hey, non auth bugs are probably the superest-duperest bugs ever! Seriously, they make my day. <img draggable="false" class="emoji" alt="🙂" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1f642.svg"></p>
<p>I believe there’s a bit of a language barrier here – I don’t think 
opt9 was trying to say that my work was a copy of his work, but rather 
that he had done some previous work on the WRT54Gs and wanted to share 
it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1623#respond" onclick='return addComment.moveForm( "comment-1623", "1623", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-1639">
		<div id="comment-1639">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8c8547d51223bf96854fef75eac09721.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8c8547d51223bf96854fef75eac09721_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">meh</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1639">
			July 17, 2011 at 2:38 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>haha</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1639#respond" onclick='return addComment.moveForm( "comment-1639", "1639", "respond", "259" )' aria-label="Reply to meh">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://hotroit.com/tintuc/?p=126" rel="external nofollow" class="url">Lổ hỏng Reverse Engineering VxWorks Firmware » Hỗ Trợ IT</a></p>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1662">
		<div id="comment-1662">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/b6f68ebad084b66ef8dcccb0bf5cebda.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/b6f68ebad084b66ef8dcccb0bf5cebda_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://twitter.com/sviehb" rel="external nofollow" class="url">sviehb</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1662">
			August 1, 2011 at 10:06 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thanks for this blog entry and your work around router firmware RE!</p>
<p>I found one small mistake <img draggable="false" class="emoji" alt="🙂" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1f642.svg"><br>
lui $a0, 1<br>
definition of lui is “Load Upper Immediate”:<br>
“The 16-bit immediate is shifted left 16 bits and concatenated with 16 bits of low-order zeros. …”<br>
so the call would look like this: malloc(1&lt;&lt;16) and would allocate 64k of memory.</p>
<p>I've done a fair bit of MIPS reverse engineering so I maybe help 
people out by telling them about the 2 things which take some time 
getting used to.</p>
<p>Argument passing (the only way I encountered this IRL):<br>
$a0-$a3 (arg_0 to arg_3)<br>
$t0-$t3 (arg_4 to arg_8)<br>
rest on stack<br>
$v0 contains the return value</p>
<p>Delay slot instructions:<br>
jump/branch instructions (excluding "branch likely instructions" eg. BEQL):<br>
"All branches have an architectural delay of one instruction. When a 
branch is taken, the instruction immediately following the branch 
instruction, in the branch delay slot, is executed before the branch to 
the target instruction takes place."</p>
<p>same for load instructions:<br>
"The time between the load instruction and the time the data is 
available is the “load delay slot”. If no useful instruction can be put 
into the load delay slot, then a null operation (assembler mnemonic NOP)
 must be inserted."</p>
<p>so if you have something like this …<br>
la      $a0, aCanTOpenDirect  # "Can't open directory %s\n"<br>
jal     printf<br>
move    $a1, $s3</p>
<p>the move $a1, $s3 instruction would be executed before the call to printf.<br>
printf("Can't open directory %s\n", $a1);</p>
<p>cheers</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1662#respond" onclick='return addComment.moveForm( "comment-1662", "1662", "respond", "259" )' aria-label="Reply to sviehb">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor even thread-even depth-1" id="li-comment-1663">
		<div id="comment-1663">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1663">
			August 3, 2011 at 11:31 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thanks for the correction sviehb! Allocating 64KB makes more sense than doing a malloc call for one byte. <img draggable="false" class="emoji" alt="🙂" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1f642.svg"> I’ve updated the post accordingly.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1663#respond" onclick='return addComment.moveForm( "comment-1663", "1663", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://www.school-guide.info/about/engineering/engineering-guide" rel="external nofollow" class="url">engineering guide - SCHOOL GUIDE – SCHOOL GUIDE</a></p>
	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://sviehb.wordpress.com/2011/09/09/reverse-engineering-an-obfuscated-firmware-image-e02-analysis/" rel="external nofollow" class="url">Reverse engineering an obfuscated firmware image E02 – analysis « .braindump – RE and stuff</a></p>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1860">
		<div id="comment-1860">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/11a6389a14e973f005bd8417eb678dbc.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/11a6389a14e973f005bd8417eb678dbc_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://friendfeed.com/?url=http%3A%2F%2Fwww.upperdarbyhighschool.net%2Fgeniuses-prodigies-freaks-geeks-building-the-identity%2F&amp;title=Building%20the%20Identity%20with%20the%20Upper%20Darby%20High%" rel="external nofollow" class="url">High School</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1860">
			September 25, 2011 at 6:13 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>That may be some sublime stuff. Ne’er knew that thoughts could be
 this various. thank you for each of the ebullience to consider such 
accommodating info at this site.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1860#respond" onclick='return addComment.moveForm( "comment-1860", "1860", "respond", "259" )' aria-label="Reply to High School">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://huaweihg612hacking.wordpress.com/2011/08/10/reverse-engineering-links/" rel="external nofollow" class="url">Reverse engineering links (placeholder) « Huawei HG612 Hacking</a></p>
	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-2209">
		<div id="comment-2209">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2209">
			November 3, 2011 at 11:06 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Hi<br>
  Im new to this. When i tried binwalk -v against a vxworks bin[our company product] file i got empty result.<br>
So i tried with binwalk -a option , results in listing huge number of files .<br>
104       	0x68      	68K BCS executable<br>
160       	0xA0      	68K BCS executable<br>
312       	0x138     	MIPSEB ECOFF executable not stripped – version 255 ^H.26<br>
788       	0x314     	MIPSEB Ucode<br>
1044      	0x414     	MIPSEB Ucode<br>
105712    	0x19CF0   	zlib compressed data<br>
107187    	0x1A2B3   	compress’d data 22 bits</p>
<p>Please guide in further proceeding as when i tried dd on zlib portion
 of compressed data the resultant is not decompress-able by 7zip.</p>
<p>Sezkar</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2209#respond" onclick='return addComment.moveForm( "comment-2209", "2209", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-2211">
		<div id="comment-2211">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2211">
			November 7, 2011 at 12:26 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>@sezkar:</p>
<p>When scanning a binary file for matching file signatures, you are 
bound to get false positive matches – probably a lot of them, as you 
encountered. Binwalk attempts to filter out false positive results, but 
the -a option disables this filtering.</p>
<p>Since this is your product, it should be pretty easy to figure out 
what is and isn’t a false positive. For example, do you use zlib? If 
not, then that’s probably a false positive. Is your devices a big-endian
 MIPS system? If not, that’s probably a false positive too. 
Unfortunately, binwalk doesn’t have signatures for everything and 
sometimes you have to do a little leg work. <img draggable="false" class="emoji" alt="🙂" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1f642.svg"></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2211#respond" onclick='return addComment.moveForm( "comment-2211", "2211", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-2214">
		<div id="comment-2214">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2214">
			November 9, 2011 at 3:54 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Hi<br>
  Thanks for the guidance. Its our product but the binary is from external entity.<br>
binwalk -v is not showing any results. Why?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2214#respond" onclick='return addComment.moveForm( "comment-2214", "2214", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-2221">
		<div id="comment-2221">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2221">
			November 9, 2011 at 9:45 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>The verbose flag causes binwalk to print out a descriptive header
 about the target file and number of loaded signatures. It doesn’t 
affect the actual signature results.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2221#respond" onclick='return addComment.moveForm( "comment-2221", "2221", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://www.devttys0.com/2011/11/speaking-spi-i2c-with-the-ft-2232/" rel="external nofollow" class="url">/dev/ttyS0 » Blog Archive » Speaking SPI &amp; I2C With The FT-2232</a></p>
	</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-2387">
		<div id="comment-2387">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2387">
			December 6, 2011 at 7:48 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Hi<br>
We have a Vxworks bin file. I extracted the zlib portion and changed the
 html file content and then loaded into the device.Sadly it failed 
stating chksum failure.Even in the original hexdump of the file changing
 a single value is throwing chksum failed when loading to the device. 
Suggestions please.</p>
<p>I hope the file is having chksum embedded into it.<br>
How to find it and modify it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2387#respond" onclick='return addComment.moveForm( "comment-2387", "2387", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment odd alt depth-2" id="li-comment-5484">
		<div id="comment-5484">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/d590ca1580965cdd44f5bfdb09b8a022.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/d590ca1580965cdd44f5bfdb09b8a022_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">tsgan</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-5484">
			November 26, 2012 at 1:35 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Is there any tool to repack files to vxworks bin firmware and fix the checksum? Did you find solution?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=5484#respond" onclick='return addComment.moveForm( "comment-5484", "5484", "respond", "259" )' aria-label="Reply to tsgan">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-2401">
		<div id="comment-2401">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2401">
			December 7, 2011 at 6:27 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Any suggestions for my previous question please?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2401#respond" onclick='return addComment.moveForm( "comment-2401", "2401", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor odd alt thread-even depth-1" id="li-comment-2413">
		<div id="comment-2413">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2413">
			December 8, 2011 at 12:58 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Most firmware images do have checksums, so I can almost guarantee
 that the VxWorks image does too, though I’m not very familiar with the 
VxWorks header format. </p>
<p>Did you try Googling it? This looks promising: <a href="http://www.bitsum.com/openwiking/owbase/WRT54G5_CFE/#h38" rel="nofollow">http://www.bitsum.com/openwiking/owbase/WRT54G5_CFE/#h38</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2413#respond" onclick='return addComment.moveForm( "comment-2413", "2413", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-2453">
		<div id="comment-2453">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2453">
			December 14, 2011 at 5:36 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thanks for the same</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2453#respond" onclick='return addComment.moveForm( "comment-2453", "2453", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-2454">
		<div id="comment-2454">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2454">
			December 14, 2011 at 5:39 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>I tried the Below Java Function to compute it .Its not working out.</p>
<p>import java.io.*;</p>
<p>public class Jeremy_method {</p>
<p>	/**<br>
	 * @param args<br>
	 */</p>
<p>	public static void main(String args[]) throws Exception {</p>
<p>		File orig_file = new File(“C:/GK_CODE/test_random_crc32/orig_dslp.bin”);<br>
		BufferedInputStream ipStream = new BufferedInputStream(<br>
				new FileInputStream(orig_file));<br>
		int idata = 0;<br>
		 int sum = 0;<br>
		while ((idata = ipStream.read()) != -1) {</p>
<p>			sum += idata;</p>
<p>		}</p>
<p>		ipStream.close();</p>
<p>		String hex_total_sum = Integer.toHexString(sum);<br>
		System.out.println(“The Sum of all firmware Addition  ”<br>
				+ (Integer.toHexString(sum)));</p>
<p>		int sum_of_chechsum = 0;</p>
<p>		for (int j = 0; j &lt; (hex_total_sum.length()); j += 2) {<br>
			// System.out.println(hex_total_sum.substring(j, j + 2));<br>
			sum_of_chechsum += Integer.parseInt(<br>
					hex_total_sum.substring(j, j + 2), 16);</p>
<p>		}</p>
<p>		System.out.println("The Sum of the checksum values  "<br>
				+ Integer.toHexString(sum_of_chechsum));</p>
<p>		int checksum = sum – sum_of_chechsum;</p>
<p>		System.out.println("The checksum is " + Integer.toHexString(checksum));</p>
<p>		System.out.println("The checksum is " + Integer.toHexString(~(sum-1)));</p>
<p>	}</p>
<p>}</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2454#respond" onclick='return addComment.moveForm( "comment-2454", "2454", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-craig bypostauthor even thread-odd thread-alt depth-1" id="li-comment-2461">
		<div id="comment-2461">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2461">
			December 15, 2011 at 4:06 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>As I said, I’m not familiar with VxWorks header formats. You’d 
probably be better off asking Jeremy about this, as he is the one who 
reversed the VxWorks image format. </p>
<p>Have you tried the wrt_vx_imgtool that Jeremy put in the Firmware Mod Kit? This will supposedly re-build WRT54G VxWorks images.</p>
<p>Also bear in mind that just because your devices is running VxWorks 
doesn’t mean that it necessarily uses the same checksums. I’d use 
Jeremy’s work as a guide to get you started, but it very well may have 
changed since he did that work.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2461#respond" onclick='return addComment.moveForm( "comment-2461", "2461", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-2471">
		<div id="comment-2471">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/255bd726a0bc717ff9e7a6a3d5f8abdb_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">sezkar</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2471">
			December 18, 2011 at 10:25 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thanks!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2471#respond" onclick='return addComment.moveForm( "comment-2471", "2471", "respond", "259" )' aria-label="Reply to sezkar">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-2614">
		<div id="comment-2614">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/69c6bcb996a4e3ca05d0e16edc6e0599.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/69c6bcb996a4e3ca05d0e16edc6e0599_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://www.deinde.net/" rel="external nofollow" class="url">deinde</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-2614">
			January 6, 2012 at 11:12 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>hi Craig and  compliment for the blog!!<br>
my router has this firmware <a href="http://www.sitecom.com/download/4017/WL601_V0.18.bin" rel="nofollow">http://www.sitecom.com/download/4017/WL601_V0.18.bin</a> i extract the second part coded in lzma and in pfs/0.9 but all the .exe files are of 0 bytes.<br>
How can i get the source of the .exe files??<br>
analyzing the first part it seems to be the boot loader, but i don’t know what to do with it.<br>
My goal is to try to emulate the firmware and possibly insert a telnet console that is not present by default.<br>
anyone knows how to do it??<br>
thanks,ciao!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=2614#respond" onclick='return addComment.moveForm( "comment-2614", "2614", "respond", "259" )' aria-label="Reply to deinde">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-11797">
		<div id="comment-11797">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/7123f3f02926230ba733dbcc30971322.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/7123f3f02926230ba733dbcc30971322_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://sec4ever.com/" rel="external nofollow" class="url">faris</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-11797">
			April 18, 2013 at 6:21 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Thanks for the great tut<br>
am just wondering , How can i install Web-GUI Firmware or extract it’s web pages @ linux box<br>
example<br>
<a href="http://www.grandstream.com/firmware/GXP21xx/Release_GXP110x_1.0.5.23.zip" rel="nofollow">http://www.grandstream.com/firmware/GXP21xx/Release_GXP110x_1.0.5.23.zip</a><br>
How can i extract the web pages from the bin file!!!!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=11797#respond" onclick='return addComment.moveForm( "comment-11797", "11797", "respond", "259" )' aria-label="Reply to faris">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://binwalk.org/projects/" rel="external nofollow" class="url">Projects | Binwalk</a></p>
	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-365683">
		<div id="comment-365683">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/b9ebc7d59e3867d9573149857c4778f9.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/b9ebc7d59e3867d9573149857c4778f9_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">anonymous</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-365683">
			October 29, 2014 at 8:22 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Hi, could you explain this sentence to me:</p>
<p>The address 0x80001000 is loaded into $v0 and the decompressImage 
function is called; execution then jumps to the address stored in $v0 
(0x80001000). So presumably, the decompressImage function decompresses 
some code to address 0x80001000, which then takes over execution.</p>
<p>why do you mention $v0? I thought $v0 and $v1 were registers for the 
return value of a function. and $aX is for passing arguments to the 
function. Isn’t this the right sentence…?</p>
<p>The address 0x80001000 is loaded into $a1 and the decompressImage 
function is called; execution then jumps to the address stored in $a1 
(0x80001000). So presumably, the decompressImage function decompresses 
some code to address 0x80001000, which then takes over execution.</p>
<p>Thx for this really nice blog</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=365683#respond" onclick='return addComment.moveForm( "comment-365683", "365683", "respond", "259" )' aria-label="Reply to anonymous">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-craig bypostauthor odd alt depth-2" id="li-comment-368479">
		<div id="comment-368479">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/6909980e321852bc16b799e38b300daf_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Craig</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-368479">
			October 29, 2014 at 10:00 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>You are correct about the use of the $aX and $v0/$v1 registers. You are also correct that the address <inline -code="">0x80001000</inline> is passed to <inline -code="">decompressImage</inline> via the <inline -code="">$a1</inline> register.</p>
<p>However, notice that <inline -code="">0x80001000</inline> is also placed in the <inline -code="">$v0</inline> register, which is subsequently stored to the <inline -code="">var_10</inline> stack variable in the delay slot of the call to <inline -code="">decompressImage</inline>. After <inline -code="">decompressImage</inline> returns, the stack value from <inline -code="">var_10</inline> is loaded back into <inline -code="">$v0</inline> just before the <inline -code="">jalr $v0</inline> instruction. This is the functionality I was particularly concerned with in this case.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=368479#respond" onclick='return addComment.moveForm( "comment-368479", "368479", "respond", "259" )' aria-label="Reply to Craig">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment even depth-3" id="li-comment-698318">
		<div id="comment-698318">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/02c10f0f46488734ba259d522f188ac8.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/02c10f0f46488734ba259d522f188ac8_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">anonymous</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-698318">
			February 1, 2015 at 3:47 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>i’ve got an additional question regarding this functionality you mentioned before.</p>
<p>Why are you explaining this? The important point at this stage is 
that the address in $a1 is passed to “decompressImage”, isn’ it? But why
 you’re mentioning register $v0?</p>
<p>I didn’t quite understand this.</p>
<p>Thanks in advance</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=698318#respond" onclick='return addComment.moveForm( "comment-698318", "698318", "respond", "259" )' aria-label="Reply to anonymous">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://www.shentou.org/hacker/410.html" rel="external nofollow" class="url">44CON议题《攻击 VxWorks：从石器时代到星际》探究 | 黑客安全军火库|SHENTOU.ORG</a></p>
	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="https://www.phillips321.co.uk/2015/11/24/hacking-the-atn-x-sight-part1/" rel="external nofollow" class="url">Hacking the ATN X-sight – part1 | phillips321.co.uk</a></p>
	</li><!-- #comment-## -->
	<li class="post pingback">
		<p>Pingback: <a href="http://hack.hk.cn/2017/02/26/44con%e8%ae%ae%e9%a2%98%e3%80%8a%e6%94%bb%e5%87%bb-vxworks%ef%bc%9a%e4%bb%8e%e7%9f%b3%e5%99%a8%e6%97%b6%e4%bb%a3%e5%88%b0%e6%98%9f%e9%99%85%e3%80%8b%e6%8e%a2%e7%a9%b6/" rel="external nofollow" class="url">44CON议题《攻击 VxWorks：从石器时代到星际》探究 - 莹莹之色</a></p>
	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-1025530">
		<div id="comment-1025530">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8083641f3c562fa0c37a571a37ae602d.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/8083641f3c562fa0c37a571a37ae602d_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn">Rafael Scheel</cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1025530">
			May 3, 2017 at 9:21 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>THX!!!<br>
Needed that little help to get started =)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1025530#respond" onclick='return addComment.moveForm( "comment-1025530", "1025530", "respond", "259" )' aria-label="Reply to Rafael Scheel">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-1031688">
		<div id="comment-1031688">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/03df192685dc2e658a590e8768719b1b.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/03df192685dc2e658a590e8768719b1b_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="https://fuckyeahmenfolk.tumblr.com/" rel="external nofollow" class="url">sex toy review</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1031688">
			June 15, 2017 at 8:18 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>I like the helpful info you provide on your articles.<br>
I will bookmark your weblog and check again here frequently.<br>
I’m rather sure I’ll be informed plenty of new stuff right right here!<br>
Best of luck for the next!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1031688#respond" onclick='return addComment.moveForm( "comment-1031688", "1031688", "respond", "259" )' aria-label="Reply to sex toy review">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-1032601">
		<div id="comment-1032601">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/4e0cff9d8aa39a1d730a9694053d2918.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/4e0cff9d8aa39a1d730a9694053d2918_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="https://fuck-yoga.tumblr.com/" rel="external nofollow" class="url">sex toys</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1032601">
			June 25, 2017 at 2:55 am</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Howdy I am so thrilled I found your web site, I really found you by accident, while<br>
I was researching on Yahoo for something else, Anyhow I am here now and<br>
would just like to say kudos for a remarkable post and a all<br>
round interesting blog (I also love the theme/design), I don’t have time to go through it all at<br>
the minute but I have book-marked it and also added in your RSS feeds, so when I have time I<br>
will be back to read a lot more, Please do keep up the excellent b.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1032601#respond" onclick='return addComment.moveForm( "comment-1032601", "1032601", "respond", "259" )' aria-label="Reply to sex toys">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-1059239">
		<div id="comment-1059239">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1fc20b9bdc35b7f1f4500a9421d00791.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/1fc20b9bdc35b7f1f4500a9421d00791_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://computerhopenowwith.com/" rel="external nofollow" class="url">Krystle</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1059239">
			May 20, 2018 at 8:15 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>It’s an remarkable piece of writing in favor of all the internet users; they will obtain advantage from it I am<br>
sure.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1059239#respond" onclick='return addComment.moveForm( "comment-1059239", "1059239", "respond", "259" )' aria-label="Reply to Krystle">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="li-comment-1061826">
		<div id="comment-1061826">
		<div class="comment-author vcard">
			<img alt="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/74f24e991fe333c0421dece96bfc5d82.jpeg" srcset="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/74f24e991fe333c0421dece96bfc5d82_002.jpeg 2x" class="avatar avatar-40 photo" width="40" height="40"><cite class="fn"><a href="http://computerhopenowwith.com/" rel="external nofollow" class="url">Cortez</a></cite> <span class="says">says:</span>


		</div><!-- .comment-author .vcard -->

		<div class="comment-meta commentmetadata"><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#comment-1061826">
			June 13, 2018 at 10:27 pm</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body">
				<p>Fine way of explaining, and nice paragraph to take information concerning<br>
my presentation focus, which i am going to convey in institution of higher education.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/?replytocom=1061826#respond" onclick='return addComment.moveForm( "comment-1061826", "1061826", "respond", "259" )' aria-label="Reply to Cortez">Reply</a>		</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	
	</ol>

	
	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="http://www.devttys0.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="259" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="06d81fcff0"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1618908616671"></form>
			</div><!-- #respond -->
	
</div><!-- #comments -->


						</div><!-- #content -->
			<div id="primary" class="widget-area" role="complementary" style="height: 32158px;">

		
		
			<ul class="xoxo">
				<li id="search-2" class="widget-container widget_search"><form method="get" id="searchform" action="http://www.devttys0.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="s" placeholder="Search" name="s">
	</label>
	<button type="submit" class="searchsubmit"><span class="screen-reader-text">Search</span>OK</button>
</form>
</li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="http://www.devttys0.com/2016/08/defcon-24-blinded-by-the-light/">Defcon 24: Blinded By The Light</a>
									</li>
											<li>
					<a href="http://www.devttys0.com/2016/01/hardware-hacking-workshop-is-now-live/">Hardware Hacking Workshop is Now Live!</a>
									</li>
											<li>
					<a href="http://www.devttys0.com/2015/12/binwalk-v2-1-1-stable-release/">Binwalk v2.1.1 Stable Release</a>
									</li>
											<li>
					<a href="http://www.devttys0.com/2015/04/what-the-ridiculous-fuck-d-link/">What the Ridiculous Fuck, D-Link?!</a>
									</li>
											<li>
					<a href="http://www.devttys0.com/2015/04/hacking-the-d-link-dir-890l/">Hacking the D-Link DIR-890L</a>
									</li>
					</ul>
		</li><li id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="https://www.tuxism.faith/" rel="external nofollow" class="url">Jake</a></span> on <a href="http://www.devttys0.com/2014/02/wrt120n-fprintf-stack-overflow/#comment-1065018">WRT120N fprintf Stack Overflow</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://www.tuxism.faith/" rel="external nofollow" class="url">Jake</a></span> on <a href="http://www.devttys0.com/contact/#comment-1064981">Contact</a></li><li class="recentcomments"><span class="comment-author-link">Nobody</span> on <a href="http://www.devttys0.com/tools/#comment-1064765">Tools</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://www.tuxism.faith/" rel="external nofollow" class="url">Jake</a></span> on <a href="http://www.devttys0.com/2012/10/jailbreaking-the-neotv/#comment-1064703">Jailbreaking the NeoTV</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://www.tuxism.faith/" rel="external nofollow" class="url">Jake</a></span> on <a href="http://www.devttys0.com/2012/10/jailbreaking-the-neotv/#comment-1064701">Jailbreaking the NeoTV</a></li></ul></li><li id="text-3" class="widget-container widget_text">			<div class="textwidget"><script async="" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/adsbygoogle.js"></script>
<!-- Medium Rectangle -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6924184061014797" data-ad-slot="2282634263"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href="http://www.devttys0.com/2016/08/">August 2016</a></li>
	<li><a href="http://www.devttys0.com/2016/01/">January 2016</a></li>
	<li><a href="http://www.devttys0.com/2015/12/">December 2015</a></li>
	<li><a href="http://www.devttys0.com/2015/04/">April 2015</a></li>
	<li><a href="http://www.devttys0.com/2014/10/">October 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/08/">August 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/07/">July 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/05/">May 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/04/">April 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/03/">March 2014</a></li>
	<li><a href="http://www.devttys0.com/2014/02/">February 2014</a></li>
	<li><a href="http://www.devttys0.com/2013/12/">December 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/11/">November 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/10/">October 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/07/">July 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/06/">June 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/04/">April 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/03/">March 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/02/">February 2013</a></li>
	<li><a href="http://www.devttys0.com/2013/01/">January 2013</a></li>
	<li><a href="http://www.devttys0.com/2012/12/">December 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/11/">November 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/10/">October 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/09/">September 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/08/">August 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/07/">July 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/06/">June 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/04/">April 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/03/">March 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/02/">February 2012</a></li>
	<li><a href="http://www.devttys0.com/2012/01/">January 2012</a></li>
	<li><a href="http://www.devttys0.com/2011/12/">December 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/11/">November 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/09/">September 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/08/">August 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/07/">July 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/06/">June 2011</a></li>
	<li><a href="http://www.devttys0.com/2011/05/">May 2011</a></li>
	<li><a href="http://www.devttys0.com/2010/12/">December 2010</a></li>
		</ul>
		</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-34"><a href="http://www.devttys0.com/category/electronics/">Electronics</a>
</li>
	<li class="cat-item cat-item-22"><a href="http://www.devttys0.com/category/embedded-systems/">Embedded Systems</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://www.devttys0.com/category/file-systems/">File Systems</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://www.devttys0.com/category/hardware/">Hardware</a>
</li>
	<li class="cat-item cat-item-23"><a href="http://www.devttys0.com/category/microcontrollers/">Microcontrollers</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://www.devttys0.com/category/news/">News</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://www.devttys0.com/category/reverse-engineering/">Reverse Engineering</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://www.devttys0.com/category/security/">Security</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.devttys0.com/category/tools/">Tools</a>
</li>
	<li class="cat-item cat-item-17"><a href="http://www.devttys0.com/category/tutorial/">Tutorial</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://www.devttys0.com/category/tutorials/">Tutorials</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.devttys0.com/category/uncategorized/">Uncategorized</a>
</li>
		</ul>
</li><li id="linkcat-3" class="widget-container widget_links"><h3 class="widget-title">Links</h3>
	<ul class="xoxo blogroll">
<li><a href="http://www.analogzoo.com/" title="Adventures in learning and designing analog electronics">Analog Zoo</a></li>
<li><a href="http://www.reaversystems.com/" title="ReaverPro">Reaver Systems</a></li>
<li><a href="http://www.eevblog.com/">EEVblog</a></li>
<li><a href="http://www.hackaday.com/">Hack A Day</a></li>

	</ul>
</li>
<li id="meta-2" class="widget-container widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="http://www.devttys0.com/wp-login.php">Log in</a></li>
			<li><a href="http://www.devttys0.com/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.devttys0.com/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</li>			</ul>

			<ul class="xoxo">
							</ul>

			
		</div><!-- #primary .widget-area -->

			</section><!-- #container -->

	<div style="clear:both;"></div>

	</div> <!-- #forbottom -->
	</div><!-- #main -->


	<footer id="footer" role="contentinfo">
		<div id="colophon">
		
			
			
		</div><!-- #colophon -->

		<div id="footer2">
		
			<div style="text-align:center;clear:both;padding-top:4px;">
	<a href="http://www.devttys0.com/" title="/dev/ttyS0" rel="home">
		/dev/ttyS0</a> | Powered by <a target="_blank" href="http://www.cryoutcreations.eu/" title="Mantra Theme by Cryout Creations">Mantra</a> &amp; <a target="_blank" href="http://wordpress.org/" title="Semantic Personal Publishing Platform">  WordPress.	</a>
</div><!-- #site-info --> 	<div class="socials" id="sfooter"> 
	
			<a target="_blank" rel="nofollow" href="https://twitter.com/devttyS0" class="socialicons social-Twitter" title="Twitter">
				<img alt="Twitter" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/Twitter.png">
			</a>
            	</div>
				
		</div><!-- #footer2 -->

	</footer><!-- #footer -->

</div><!-- #wrapper -->

<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shCore.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushAS3.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushBash.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushColdFusion.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushClojure.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushCpp.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushCSharp.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushCss.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushDelphi.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushDiff.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushErlang.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushFSharp.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushGroovy.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushJava.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushJavaFX.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushJScript.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushLatex.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushMatlabKey.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushObjC.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushPerl.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushPhp.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushPlain.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushPowerShell.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushPython.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushR.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushRuby.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushScala.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushSql.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushVb.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/shBrushXml.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.devttys0.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.devttys0.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/comment-reply.js"></script>
<script type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/wp-embed.js"></script>
<script async="async" type="text/javascript" src="Reverse%20Engineering%20VxWorks%20Firmware%20WRT54Gv8%20%E2%80%93%20_dev_ttyS0_files/form.js"></script>



</body></html>